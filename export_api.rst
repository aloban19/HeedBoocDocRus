=======
API для экспорта данных
=======

Для менеджеров доступен специально разработанный API, 
позволяющий экспортировать собранные данные для собственных нужд в формате JSON

Авторизация
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Чтобы совершать запросы к API, необходимо получить токен.


+--------+----------------------------------------------------+
|POST    | https://identity.heedbook.com/account/generatetoken|
+--------+----------------------------------------------------+
|username| адрес электронной почты пользователя               |
+--------+----------------------------------------------------+
|pswd    | пароль                                             |
+--------+----------------------------------------------------+


Если авторизация пройдет успешно, пользователю будет доступен собственный уникальный идентификатор и подписанный JWT токен. 
Эти данные будут необходимы для непосредственного экспорта данных.

Экспорт сессий
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Получив сгенерированный токен, пользователь может выгрузить данные.


+---------------------+--------------------------------------------------------------------------------+
|Method: GET          | http://identity.heedbook.com/api/CompanySessions/                              |
+---------------------+--------------------------------------------------------------------------------+
|Header: Authorization| JWT токен                                                                      |
+---------------------+--------------------------------------------------------------------------------+

Пользователю доступны опциональные параметры экспорта, вписываемые в строку запроса:

Query-параметры:
 * begTime: необязателен. - время начала сессии в формате "yyyyMMdd".
 * endTime: необязателен. - время окончания сессии в формате "yyyyMMdd".
 * officeId - необязателен. -  массив названий АЗС.

Результат - список сессий по всем офисам за последние семь дней (без query-параметров).
 
 
.. code-block:: JSON

 [
    {
        "sessionId": "b140448e-8440-4305-e0d3-08d60449ab68",
        "userId": "7f46106c-e014-444d-9982-65cd3f502d71",
        "firstName": "Иван",
        "lastName": "Иванов",
        "middleName": "Иванович",
        "begOffice": "Офис 1",
        "endOffice": "Офис 1",
        "begTime": "2018-08-17T13:59:37.4309366",
        "endTime": "2018-08-17T14:01:06.5408691"
    },
    {
        "sessionId": "140dde79-785c-4383-e0d4-08d60449ab68",
        "userId": "7f46106c-e014-444d-9982-65cd3f502d71",
        "firstName": "Иван",
        "lastName": "Иванов",
        "middleName": "Иванович",
        "begOffice": "Офис 1",
        "endOffice": "Офис 1",
        "begTime": "2018-08-17T14:23:44.3180886",
        "endTime": "2018-08-17T14:24:13.04697"
    }
 ]


1) "sessionId": Id сессии 

2) "userId": ID сотрудника 

3) "firstName": Имя

4) "lastName": Фамилия

5) "middleName": Отчество 

6) "begOffice": Офис, где произошла идентификация начала смены 

7) "endOffice": Офис, где произошла идентификация окончания смены 

8) "begTime": Дата и время начала смены 

9) "endTime": Дата и время окончания смены


Экспорт сотрудников
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Получив сгенерированный токен, пользователь может выгрузить данные.


+---------------------+--------------------------------------------------------------------------------+
|Method: GET          | https://identity.heedbook.com/api/CompanyStaff                                 |
+---------------------+--------------------------------------------------------------------------------+
|Header: Authorization| JWT токен                                                                      |
+---------------------+--------------------------------------------------------------------------------+

Пользователю доступны опциональные параметры экспорта, вписываемые в строку запроса:



Результат - список сотрудников по всем офисам за последние семь дней (без query-параметров).
 
 
.. code-block:: JSON

 [
    {
        "userId": "7f46106c-e014-444d-9982-65cd3f502d71",
        "firstName": "Иван",
        "lastName": "Иванов",
        "middleName": "Иванович",
        "office": "1036",
        "position": "Заправщик"
        "creationDate": "2018-03-13T00:00:00"
    },
    {
        "userId": "88f27b18-23e3-4523-9c2a-5a8158e3d95d",
        "firstName": "Иван",
        "lastName": "Иванов",
        "middleName": "Иванович",
        "office": "1036",
        "position": "Заправщик",
        "creationDate": "2018-08-09T00:00:00"
    }
 ]


1) "userId": ID сотрудника
        
2) "firstName": Имя

3) "lastName": Фамилия

4) "middleName": Отчество

5) "office": ID офиса

6) "position": Должность 

7) "creationDate": Дата регистрации в системе
